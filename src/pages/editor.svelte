<script>
  import EditorJS from "@editorjs/editorjs";
  import Paragraph from "@editorjs/paragraph";
  import Header from "@editorjs/header";
  import List from "@editorjs/list";
  import SimpleImage from "@editorjs/simple-image";
  import ColorPlugin from "editorjs-text-color-plugin";
  import { onMount } from "svelte";
  import edjsHTML from "editorjs-html";
  let editor;
  let editorInstance;
  let x =
    '<h2> New header </h2><p> Job purpose </p><p> Provide a brief description of the general nature of the position; an overview of why the job exists; and what the job is to accomplish. </p><p> The job purpose is usually no more than a few sentences long. </p><p> Duties and responsibilities </p><p> List the primary job duties and responsibilities using headings and then give examples of the types of activities under each heading. Identify between three and eight primary duties and responsibilities for the position. </p><ul> <li> List the primary duties and responsibilities in order of importance </li><li> Begin each statement with an action verb </li><li> Use the present tense of verbs </li><li> Use gender neutral language </li><li> Use generic language </li><li> Where appropriate use qualifiers to clarify the task – where, when, why or how often – for example instead of “greet visitor to the office” use “greet visitors to the office in a professional and friendly manner” </li> </ul><p> Qualifications </p><p> State the minimum qualifications required to successfully perform the job. </p><p> Qualifications include </p><ul> <li> Education </li><li> Specialized knowledge </li><li> Skills </li><li> Abilities </li><li> Other characteristics such as personal characteristics </li><li> Professional Certification </li><li> Experience </li> </ul><p> Perks/Benefits of the role </p><img src="https://www.tesla.com/tesla_theme/assets/img/_vehicle_redesign/roadster_and_semi/roadster/hero.jpg" />';
  onMount(async () => {
    editorInstance = new EditorJS({
      holder: editor,
      hideToolbar: false,
      inlineToolbar: true,
      tools: {
        paragraph: {
          class: Paragraph,
          inlineToolbar: true,
        },
        header: {
          class: Header,
          config: {
            placeholder: "Enter a header",
            levels: [2, 4],
            defaultLevel: 2,
          },
          inlineToolbar: true,
        },
        list: {
          class: List,
          inlineToolbar: true,
        },
        image: {
          class: SimpleImage,
          inlineToolbar: true,
        },
        Color: {
          class: ColorPlugin,
          config: {
            colorCollections: [
              "#FF1300",
              "#EC7878",
              "#9C27B0",
              "#673AB7",
              "#3F51B5",
              "#0070FF",
              "#03A9F4",
              "#00BCD4",
              "#4CAF50",
              "#8BC34A",
              "#CDDC39",
              "#FFF",
              "#000000",
            ],
            defaultColor: "#000000",
            type: "text",
          },
        },
        Marker: {
          class: ColorPlugin,
          config: {
            defaultColor: "#FFBF00",
            type: "marker",
          },
        },
      },
    });

    console.log(x, "String USED TO RENDER ON LOAD");
    await editorInstance.isReady;
    editorInstance.blocks.renderFromHTML(x);
  });

  const imageParser = (image) => {
    return `<img src="${image.data.url}" />`;
  };

  const edjsParser = edjsHTML({ image: imageParser });

  const save = async () => {
    const result = await editorInstance.save();
    const parserHtml = edjsParser.parse(result);
    console.log(parserHtml.join(""), "SAVED DATA");
  };
</script>

<div class="bg-gray-200 p-10 rounded-md">
  <div bind:this={editor} class="bg-white" />
</div>

<button
  class="bg-blue-500 rounded-md text-white p-4 w-full"
  on:click={async () => await save()}
>
  Save
</button>

<style global>
  h2 {
    font-size: 24px;
    font-weight: 600;
  }
</style>
